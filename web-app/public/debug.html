<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WordLog æ•°æ®è°ƒè¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { color: #D97757; margin-bottom: 20px; }
        .word-item {
            border: 1px solid #e0e0e0;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            background: #fafafa;
        }
        .word-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        .word-detail {
            font-size: 14px;
            color: #666;
            margin: 5px 0;
        }
        .word-detail span {
            color: #D97757;
            font-weight: 500;
        }
        button {
            background: #D97757;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #c06649; }
        button.secondary { background: #666; }
        button.secondary:hover { background: #555; }
        .result {
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e9;
            border-radius: 8px;
            color: #2e7d32;
        }
        .error {
            background: #ffebee;
            color: #c62828;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š WordLog æ•°æ®è°ƒè¯•å·¥å…·</h1>

        <button onclick="showAllWords()">ğŸ“‹ æ˜¾ç¤ºæ‰€æœ‰å•è¯</button>
        <button onclick="checkSpecificWords()" class="secondary">ğŸ” æ£€æŸ¥ç‰¹å®šå•è¯</button>
        <button onclick="fixSprouting()" class="secondary">ğŸ”§ ä¿®å¤ sprouting</button>
        <button onclick="clearAndReload()" class="secondary">ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>

        <div id="output"></div>
    </div>

    <script>
        // å†…ç½®ä¸­æ–‡é‡Šä¹‰åº“ï¼ˆä» dictionaryAPI.js å¤åˆ¶ï¼‰
        const CHINESE_DEFINITIONS = {
            'sprouting': {
                pronunciation: '/ËˆspraÊŠtÉªÅ‹/',
                partOfSpeech: 'åŠ¨è¯',
                definition: 'å‘èŠ½ï¼›é•¿å‡ºï¼›èŒèŠ½',
                example: 'The seeds are sprouting early this year.',
                exampleTranslation: 'ç§å­ä»Šå¹´å‘èŠ½å¾ˆæ—©ã€‚'
            },
            'philosophising': {
                pronunciation: '/fÉªËˆlÉ’sÉ™faÉªzÉªÅ‹/',
                partOfSpeech: 'åŠ¨è¯',
                definition: 'è¿›è¡Œå“²å­¦æ€è€ƒï¼›å“²å­¦åŒ–',
                example: 'He is philosophising about the nature of reality.',
                exampleTranslation: 'ä»–æ­£åœ¨æ€è€ƒç°å®çš„æœ¬è´¨ã€‚'
            },
            'crunched': {
                pronunciation: '/krÊŒntÊƒt/',
                partOfSpeech: 'åŠ¨è¯',
                definition: 'å‹ç¢ï¼›å˜å±ä½œå“åœ°å’€åš¼ï¼›æŒ¤å‹',
                example: 'She crunched the numbers in her head.',
                exampleTranslation: 'å¥¹åœ¨è„‘æµ·ä¸­ç›˜ç®—ç€è¿™äº›æ•°å­—ã€‚'
            },
            'bloating': {
                pronunciation: '/ËˆblÉ™ÊŠtÉªÅ‹/',
                partOfSpeech: 'åŠ¨è¯',
                definition: 'è†¨èƒ€ï¼›è‚¿èƒ€ï¼›æµ®å¤¸',
                example: 'The bloated corpse floated on the river.',
                exampleTranslation: 'è‚¿èƒ€çš„å°¸ä½“æ¼‚æµ®åœ¨æ²³é¢ä¸Šã€‚'
            },
            'tempering': {
                pronunciation: '/ËˆtempÉ™rÉªÅ‹/',
                partOfSpeech: 'åè¯/åŠ¨è¯',
                definition: 'å›ç«ï¼›æ·¬ç‚¼ï¼›è°ƒèŠ‚ï¼›é”»ç‚¼',
                example: 'The tempering of steel requires skill.',
                exampleTranslation: 'é’¢æçš„å›ç«å¤„ç†éœ€è¦æŠ€å·§ã€‚'
            },
            'twisting': {
                pronunciation: '/ËˆtwÉªstÉªÅ‹/',
                partOfSpeech: 'åŠ¨è¯/åè¯',
                definition: 'æ‰­æ›²ï¼›è½¬åŠ¨ï¼›æ»',
                example: 'She was twisting her hair nervously.',
                exampleTranslation: 'å¥¹ç´§å¼ åœ°å·ç€å¤´å‘ã€‚'
            },
            'bloviating': {
                pronunciation: '/ËˆblÉ™viËŒeÉªtÉªÅ‹/',
                partOfSpeech: 'åŠ¨è¯',
                definition: 'å¤¸å¤¸å…¶è°ˆï¼›è¯´å¤§è¯ï¼›æµ®å¤¸',
                example: 'He kept bloviating about his achievements.',
                exampleTranslation: 'ä»–ä¸€ç›´å¤¸è€€è‡ªå·±çš„æˆå°±ã€‚'
            }
        };

        function showOutput(html, isError = false) {
            const output = document.getElementById('output');
            output.innerHTML = `<div class="result ${isError ? 'error' : ''}">${html}</div>`;
        }

        function showAllWords() {
            const data = localStorage.getItem('wordlog_words');
            if (!data) {
                showOutput('âŒ æ²¡æœ‰æ‰¾åˆ°å•è¯æ•°æ®', true);
                return;
            }

            const words = JSON.parse(data);
            let html = `<h3>å…±æœ‰ ${words.length} ä¸ªå•è¯</h3>`;

            words.forEach((w, i) => {
                html += `
                    <div class="word-item">
                        <div class="word-title">${i + 1}. ${w.word}</div>
                        <div class="word-detail">wordLower: <span>"${w.wordLower}"</span></div>
                        <div class="word-detail">source: <span>${w.source || 'undefined'}</span></div>
                        <div class="word-detail">pronunciation: <span>${w.pronunciation || 'undefined'}</span></div>
                        <div class="word-detail">definitions: <span>${w.definitions ? JSON.stringify(w.definitions) : 'NO DEFINITIONS'}</span></div>
                    </div>
                `;
            });

            showOutput(html);
        }

        function checkSpecificWords() {
            const targetWords = ['sprouting', 'philosophising', 'crunched', 'bloating', 'tempering', 'twisting', 'bloviating'];
            const data = localStorage.getItem('wordlog_words');
            if (!data) {
                showOutput('âŒ æ²¡æœ‰æ‰¾åˆ°å•è¯æ•°æ®', true);
                return;
            }

            const words = JSON.parse(data);
            let html = '<h3>æ£€æŸ¥ç‰¹å®šå•è¯</h3>';

            targetWords.forEach(target => {
                const found = words.find(w => w.wordLower === target);
                if (found) {
                    const hasChinese = found.definitions && found.definitions[0] &&
                                       !found.definitions[0].definition.includes('æŸ¥è¯¢ä¸­') &&
                                       !found.definitions[0].definition.includes('é‡Šä¹‰æš‚ä¸å¯ç”¨');

                    html += `
                        <div class="word-item">
                            <div class="word-title">âœ… æ‰¾åˆ°: ${target}</div>
                            <div class="word-detail">ä¸­æ–‡é‡Šä¹‰: <span>${hasChinese ? 'âœ… æœ‰' : 'âŒ æ—  - ' + JSON.stringify(found.definitions)}</span></div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="word-item">
                            <div class="word-title">âŒ æœªæ‰¾åˆ°: ${target}</div>
                        </div>
                    `;
                }
            });

            showOutput(html);
        }

        function fixSprouting() {
            const data = localStorage.getItem('wordlog_words');
            if (!data) {
                showOutput('âŒ æ²¡æœ‰æ‰¾åˆ°å•è¯æ•°æ®', true);
                return;
            }

            let words = JSON.parse(data);
            let fixedCount = 0;
            const fixedWords = [];

            words = words.map(word => {
                // è§„èŒƒåŒ–ï¼šå»é™¤ç©ºæ ¼ï¼Œè½¬å°å†™
                const wordOriginal = word.word || '';
                const wordLower = wordOriginal.toLowerCase().trim();

                // æ£€æŸ¥æ˜¯å¦åœ¨å†…ç½®åº“ä¸­
                if (CHINESE_DEFINITIONS[wordLower]) {
                    const builtin = CHINESE_DEFINITIONS[wordLower];
                    fixedCount++;
                    fixedWords.push(wordOriginal);

                    return {
                        ...word,
                        word: wordOriginal,
                        wordLower: wordLower,
                        pronunciation: builtin.pronunciation,
                        definitions: [{
                            partOfSpeech: builtin.partOfSpeech,
                            definition: builtin.definition,
                            example: builtin.example,
                            exampleTranslation: builtin.exampleTranslation
                        }],
                        source: 'builtin-fixed',
                        updatedAt: Date.now()
                    };
                }

                return word;
            });

            localStorage.setItem('wordlog_words', JSON.stringify(words));

            let resultHtml = `âœ… å·²ä¿®å¤ <strong>${fixedCount}</strong> ä¸ªå•è¯çš„ä¸­æ–‡é‡Šä¹‰ï¼<br><br>`;
            resultHtml += `ä¿®å¤çš„å•è¯ï¼š${fixedWords.join(', ') || 'æ— '}<br><br>`;
            resultHtml += `<strong>è¯·åˆ·æ–°ä¸»é¡µé¢æŸ¥çœ‹æ•ˆæœï¼</strong>`;
            showOutput(resultHtml);
        }

        function clearAndReload() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å•è¯æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼')) {
                localStorage.removeItem('wordlog_words');
                localStorage.removeItem('wordlog_stats');
                showOutput('âœ… å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®');
                setTimeout(() => location.reload(), 1500);
            }
        }
    </script>
</body>
</html>
